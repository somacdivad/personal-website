---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout
	title="Blog"
	description="David Amos is waxing philosophical about technology, parenting, music, and life."
>
	<main>
		{
			posts.length ? (
				<section class="blog-posts">
					<ul>
						{
							posts.map((post) => (
								<li>
									<a href={`/blog/${post.id}/`}>
										{post.data.heroImage && (
											<Image width={720} height={360} src={post.data.heroImage} alt="" />
										)}
										<h4 class="title">{post.data.title}</h4>
										<p class="date">
											<FormattedDate date={post.data.pubDate} />
										</p>
									</a>
								</li>
							))
						}
					</ul>
				</section>
			) : (
				<section class="flex min-h-[60vh] items-center justify-center">
					<p class="text-center text-2xl font-semibold text-gray-500">Coming soon...</p>
				</section>
			)
		}
	</main>
</BaseLayout>
